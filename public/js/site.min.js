/*! bitflopme 2013-11-26 */
var site=angular.module("site",[]);site.controller("CollapseCtrl",function($rootScope,$scope){$scope.isCollapsed=!0}),site.controller("RegisterCtrl",["$scope",function($scope){$scope.submitted=!1,$scope.token=null}]),site.controller("NewGameCtrl",["$scope",function($scope){$scope.submitted=!1,$scope.token=null,$scope.BBCount=null}]),site.directive("collapse",[function(){return{link:function(scope,element,attrs){var isCollapsed;scope.$watch(attrs.collapse,function(value){value?collapse():expand()});var expand=function(){element.addClass("in"),isCollapsed=!1},collapse=function(){isCollapsed=!0,element.removeClass("in")}}}}]),site.directive("dropdownToggle",["$document",function($document){var openElement=null,closeMenu=angular.noop;return{restrict:"CA",link:function(scope,element){element.parent().bind("click",function(){closeMenu()}),element.bind("click",function(event){var elementWasOpen=element===openElement;event.preventDefault(),event.stopPropagation(),openElement&&closeMenu(),elementWasOpen||(element.parent().addClass("open"),openElement=element,closeMenu=function(event){event&&(event.preventDefault(),event.stopPropagation()),$document.unbind("click",closeMenu),element.parent().removeClass("open"),closeMenu=angular.noop,openElement=null},$document.bind("click",closeMenu))})}}}]),site.directive("uniqueUsername",["$http","$timeout",function($http){return{require:"ngModel",link:function(scope,ele,attrs,ctrl){scope.$watch(attrs.ngModel,function(val){return val?($http({method:"POST",url:"/api/username/",data:{_csrf:scope.token,username:val}}).success(function(){ctrl.$setValidity("unique",!0)}).error(function(data){data.pattern?ctrl.$setValidity("pattern",!1):data.taken&&ctrl.$setValidity("unique",!1)}),void 0):(ctrl.$setValidity("unique",!0),void 0)})}}}]),site.directive("ngFocus",[function(){return{restrict:"A",require:"ngModel",link:function(scope,element,attrs,ctrl){ctrl.$focused=!1,element.bind("focus",function(){scope.$apply(function(){ctrl.$focused=!0})}).bind("blur",function(){scope.$apply(function(){ctrl.$focused=!1})})}}}]),site.directive("pwConfirm",[function(){return{restrict:"A",require:"ngModel",link:function(scope,elem,attrs,ctrl){var checker=function(){var password=scope.$eval(attrs.ngModel),passwordConfirm=scope.$eval(attrs.pwConfirm);return password==passwordConfirm};scope.$watch(checker,function(confirm){ctrl.$setValidity("confirm",confirm)})}}}]),site.directive("smallBlind",[function(){return{restrict:"A",require:"ngModel",link:function(scope,elem,attrs,ctrl){scope.$watch(attrs.ngModel,function(smallBlind){if(smallBlind=parseInt(smallBlind,10),!isNaN(smallBlind)){var inRange=smallBlind>0&&1e3>=smallBlind,chipStack=scope.chipStack;ctrl.$setValidity("range",inRange),scope.bigBlind=2*smallBlind,scope.newgame.chipStack.$dirty&&(chipStack<5*scope.bigBlind||chipStack>100*scope.bigBlind?(scope.newgame.chipStack.$setValidity("range",!1),scope.BBCount=null):(scope.newgame.chipStack.$setValidity("range",!0),scope.BBCount=Math.round(chipStack/scope.bigBlind)))}})}}}]),site.directive("chipStack",[function(){return{restrict:"A",require:"ngModel",link:function(scope,elem,attrs,ctrl){scope.$watch(attrs.ngModel,function(chipStack){chipStack=parseInt(chipStack,10);var bigBlind=parseInt(scope.$eval(attrs.chipStack),10),nanCS=isNaN(chipStack),nanBB=isNaN(bigBlind);return nanCS||nanBB?(ctrl.$setValidity("range",!0),void 0):(5*bigBlind>chipStack||chipStack>100*bigBlind?(ctrl.$setValidity("range",!1),scope.BBCount=null):(ctrl.$setValidity("range",!0),scope.BBCount=Math.round(chipStack/bigBlind)),void 0)})}}}]);