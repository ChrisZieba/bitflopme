/*! bitflopme 2013-11-25 */
var site=angular.module("site",[]);site.controller("CollapseCtrl",function(a,b){b.isCollapsed=!0}),site.controller("RegisterCtrl",["$scope",function(a){a.submitted=!1,a.token=null}]),site.controller("NewGameCtrl",["$scope",function(a){a.submitted=!1,a.token=null,a.BBCount=null}]),site.directive("collapse",[function(){return{link:function(a,b,c){var d;a.$watch(c.collapse,function(a){a?f():e()});var e=function(){b.addClass("in"),d=!1},f=function(){d=!0,b.removeClass("in")}}}}]),site.directive("dropdownToggle",["$document",function(a){var b=null,c=angular.noop;return{restrict:"CA",link:function(d,e){e.parent().bind("click",function(){c()}),e.bind("click",function(d){var f=e===b;d.preventDefault(),d.stopPropagation(),b&&c(),f||(e.parent().addClass("open"),b=e,c=function(d){d&&(d.preventDefault(),d.stopPropagation()),a.unbind("click",c),e.parent().removeClass("open"),c=angular.noop,b=null},a.bind("click",c))})}}}]),site.directive("uniqueUsername",["$http","$timeout",function(a){return{require:"ngModel",link:function(b,c,d,e){b.$watch(d.ngModel,function(c){return c?(a({method:"POST",url:"/api/username/",data:{_csrf:b.token,username:c}}).success(function(){e.$setValidity("unique",!0)}).error(function(a){a.pattern?e.$setValidity("pattern",!1):a.taken&&e.$setValidity("unique",!1)}),void 0):(e.$setValidity("unique",!0),void 0)})}}}]),site.directive("ngFocus",[function(){return{restrict:"A",require:"ngModel",link:function(a,b,c,d){d.$focused=!1,b.bind("focus",function(){a.$apply(function(){d.$focused=!0})}).bind("blur",function(){a.$apply(function(){d.$focused=!1})})}}}]),site.directive("pwConfirm",[function(){return{restrict:"A",require:"ngModel",link:function(a,b,c,d){var e=function(){var b=a.$eval(c.ngModel),d=a.$eval(c.pwConfirm);return b==d};a.$watch(e,function(a){d.$setValidity("confirm",a)})}}}]),site.directive("smallBlind",[function(){return{restrict:"A",require:"ngModel",link:function(a,b,c,d){a.$watch(c.ngModel,function(b){if(b=parseInt(b,10),!isNaN(b)){var c=b>0&&1e3>=b,e=a.chipStack;d.$setValidity("range",c),a.bigBlind=2*b,a.newgame.chipStack.$dirty&&(e<5*a.bigBlind||e>100*a.bigBlind?(a.newgame.chipStack.$setValidity("range",!1),a.BBCount=null):(a.newgame.chipStack.$setValidity("range",!0),a.BBCount=Math.round(e/a.bigBlind)))}})}}}]),site.directive("chipStack",[function(){return{restrict:"A",require:"ngModel",link:function(a,b,c,d){a.$watch(c.ngModel,function(b){b=parseInt(b,10);var e=parseInt(a.$eval(c.chipStack),10),f=isNaN(b),g=isNaN(e);return f||g?(d.$setValidity("range",!0),void 0):(5*e>b||b>100*e?(d.$setValidity("range",!1),a.BBCount=null):(d.$setValidity("range",!0),a.BBCount=Math.round(b/e)),void 0)})}}}]);